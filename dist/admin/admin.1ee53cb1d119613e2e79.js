(()=>{"use strict";function e(){document.querySelector("#content").innerHTML='\n    <div class="preloader"></div>\n    <p style="padding-bottom: 4vh !important;" id="preloader-text">ładowanie...</p>\n'}function n(){document.querySelector("#content").innerHTML=""}var t,a=document.querySelector(".admin-menu"),o=document.querySelector(".admin-menu:last-child"),r=0;function i(t){var s=document.querySelector("#content");n();var l=document.createElement("h5");l.innerHTML="Wybrano: ".concat(t.date,", ").concat(t.day),l.style.textAlign="center",s.appendChild(l),e();var d=new URLSearchParams({day:t.date}),m=t;fetch("/downloadHoursOfDay/?".concat(d),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(a){n();var o=document.createElement("h5");if(o.innerHTML="Wybrano: ".concat(t.date,", ").concat(t.day),o.style.textAlign="center",s.appendChild(o),t.termins.length<=0){var r=document.createElement("div");r.innerHTML="<span>Wybrano niedziele. W ten dzień salon jest zamknięty.</span>",s.appendChild(r)}else!function(){var n=[];a.list.forEach((function(e){n.push(e.hour)}));var o=[];t.termins.forEach((function(e){var t=document.createElement("div");t.classList.add("content_item-admin"),t.classList.add("content_item"),-1!=n.indexOf(e)?(t.innerHTML='\n                            <span class="content_item_left">'.concat(a.list[n.indexOf(e)].names,'</span> \n                            <span class="content_item_left content_hour">').concat(e,'</span> \n                            <span class="content_item_center">').concat(a.list[n.indexOf(e)].service,'</span>\n                            <span class="content_item_center">').concat(a.list[n.indexOf(e)].phone,'</span>\n                            <span class="content_item_right admin-btns">\n                            <img class="add" style="margin-right: 20px;" src="../img/disableAdd.svg" alt="Dodaj nową">\n                            <img class="count" style="margin-right: 20px;" src="../img/countVisit.svg" alt="Sprawdź wizyty">\n                            <img class="message" style="margin-right: 20px;" src="../img/message.svg" alt="Wyślij przypomnienie">\n                            <img class="remove" style="margin-right: 20px;" src="../img/remove.svg" alt="anuluj rezerwacje">\n                            <img class="block" src="../img/disableBlock.svg" alt="Blokuj termin">\n                            </span>'),o.push({name:a.list[n.indexOf(e)].names,termin:e,service:a.list[n.indexOf(e)].service,phone:a.list[n.indexOf(e)].phone})):(t.innerHTML='\n                        <span class="content_item_left">-----</span> \n                        <span class="content_item_left content_hour">'.concat(e,'</span> \n                        <span class="content_item_center">-----</span>\n                        <span class="content_item_center">-----</span>\n                        <span class="content_item_right admin-btns">\n                        <img class="add" style="margin-right: 20px;" src="../img/add.svg" alt="Dodaj nową">\n                        <img class="count" style="margin-right: 20px;" src="../img/disableCount.svg" alt="Sprawdź wizyty">\n                        <img class="message" style="margin-right: 20px;" src="../img/disableMessage.svg" alt="Wyślij przypomnienie">\n                        <img class="remove" style="margin-right: 20px;" src="../img/disableRemove.svg" alt="anuluj rezerwacje">\n                        <img class="block" src="../img/block.svg" alt="Blokuj termin">\n                        </span>'),o.push({name:"-----",termin:e,service:"-----",phone:"-----"})),s.appendChild(t)}));for(var r=Array.from(document.querySelectorAll(".add")),c=Array.from(document.querySelectorAll(".remove")),l=Array.from(document.querySelectorAll(".count")),d=Array.from(document.querySelectorAll(".block")),u=Array.from(document.querySelectorAll(".message")),p=0;p<r.length;p++)r[p].addEventListener("click",(function(n){var a=r.indexOf(n.target);"-----"!==o[a].name?alert("Nie można dodać rezerwacji w zajętym terminie. Wybierz inny termin."):(s.innerHTML='\n                            <form style="box-sizing: border-box;" class="addNewForm" method="GET">\n                                <input type="text" class="termin" readonly value="'.concat(o[a].termin,'">\n                                <input type="text" class="day" readonly value="').concat(t.date,'">\n                                <select class="service" required>\n                                    <option>Całe ciało</option>\n                                    <option>Twarz, szyja, dekolt</option>\n                                    <option>Same nogi</option>\n                                    <option>Od pasa w górę</option>\n                                </select>\n                                <input type="number" class="phone" required placeholder="Wpisz numer telefonu">\n                                <input type="text" class="names" required placeholder="Wpisz imię i nazwisko">\n                                <input type="text" class="mail" required placeholder="Wpisz e-mail">\n                                <input type="submit" value="Dodaj">\n                            </form>'),document.querySelector(".addNewForm").addEventListener("submit",(function(n){n.preventDefault();var a=new URLSearchParams({name:document.querySelector(".addNewForm .names").value,termin:document.querySelector(".addNewForm .termin").value,service:document.querySelector(".addNewForm .service").value,phone:document.querySelector(".addNewForm .phone").value,mail:document.querySelector(".addNewForm .mail").value,day:t.date});fetch("/addNew/?".concat(a),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(n){alert(n.message),e(),i(m)})).catch((function(e){alert("Coś poszło nie tak. Błąd w dodawaniu wizyty."),console.log(e)}))})))}));for(var y=0;y<c.length;y++)c[y].addEventListener("click",(function(n){var a=c.indexOf(n.target);if("-----"==o[a].name)alert("Nie można usunąć terminu, który jest wolny!");else{var r=new URLSearchParams({name:o[a].name,termin:o[a].termin,service:o[a].service,phone:o[a].phone,day:t.date});fetch("/remove/?".concat(r),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(n){alert(n.message),e(),i(m)})).catch((function(e){alert("Coś poszło nie tak. Błąd w usuwaniu wizyty."),console.log(e)}))}}));for(var h=0;h<l.length;h++)l[h].addEventListener("click",(function(e){var n=l.indexOf(e.target);if("-----"==o[n].name)alert("Nie można sprawdzić ilości wizyt dla niezadeklarowanego terminu.");else if("WOLNE"==o[n].name)alert("Nie można sprawdzić ilości wizyt dla zablokowanego terminu.");else{var t=new URLSearchParams({name:o[n].name});fetch("/visitCount/?".concat(t),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(e){alert(e.message)})).catch((function(e){alert("Coś poszło nie tak. Błąd w sprawdzaniu ilości wizyt."),console.log(e)}))}}));for(var g=0;g<d.length;g++)d[g].addEventListener("click",(function(n){var a=d.indexOf(n.target);if("-----"!=o[a].name)alert("Nie można zablokować zajętego terminu.");else{var r=new URLSearchParams({termin:o[a].termin,day:t.date});fetch("/block/?".concat(r),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(n){alert(n.message),e(),i(m)})).catch((function(e){alert("Coś poszło nie tak. Błąd w blokowaniu wizyty."),console.log(e)}))}}));for(var f=0;f<u.length;f++)u[f].addEventListener("click",(function(e){var n=u.indexOf(e.target);if("-----"==o[n].name)alert("Nie można wysłać wiadomości do niezarezerwowanego terminu.");else if("WOLNE"==o[n].name)alert("Nie można wysłać wiadomości do zablokowanego terminu.");else{var a=new URLSearchParams({name:o[n].name,termin:o[n].termin,service:o[n].service,phone:o[n].phone,day:t.date});fetch("/sendMessage/?".concat(a),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(e){alert(e.message)})).catch((function(e){alert("Coś poszło nie tak. Błąd w wysyłaniu przypomnienia."),console.log(e)}))}}))}()})).catch((function(e){console.log(e)})),a.innerHTML='<span class="back-btn">Powrót</span>',o.innerHTML='<span class="back-btn">Powrót</span>',a.addEventListener("click",(function(){n(),c(r)})),o.addEventListener("click",(function(){n(),c(r)}))}function c(t){!function(){a.innerHTML='\n    <span class="thirtyPreviouses">30 wcześniej</span>\n    <span class="thirtyNext">30 później</span>',o.innerHTML='            \n    <span class="thirtyPreviouses">30 wcześniej</span>\n    <span class="thirtyNext">30 później</span>';for(var e=Array.from(document.querySelectorAll(".thirtyPreviouses")),n=Array.from(document.querySelectorAll(".thirtyNext")),t=0;t<e.length;t++)e[t].addEventListener("click",(function(){c(r-=30)}));for(var i=0;i<n.length;i++)n[i].addEventListener("click",(function(){c(r+=30)}))}(),e();var s=new URLSearchParams({ammount:t});fetch("/downloadData/?".concat(s),{method:"get",headers:{"Content-Type":"application/json"},mode:"cors"}).then((function(e){return e.json()})).then((function(e){var t,a;n(),t=e.nextThirtyDays,a=document.querySelector("#content"),t.forEach((function(e){var n=document.createElement("div");n.classList.add("content_item");var t=e.freeTermins+" wolnych terminów";0==e.freeTermins&&(t="Brak terminów"),n.innerHTML='\n            <span class="content_item_left">'.concat(e.date,", ").concat(e.day,'</span>\n            <span class="content_item_center">').concat(t,'</span> \n            <span class="content_item_right admin-days">Wybierz</span>\n            '),a.appendChild(n)})),function(e){for(var n=Array.from(document.querySelectorAll(".admin-days")),t=0;t<n.length;t++)n[t].addEventListener("click",(function(t){var a=n.indexOf(t.target);i(e[a])}))}(e.nextThirtyDays)})).catch((function(e){console.log(e)}))}c(r),t=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),document.querySelector(".dateDay").innerHTML="Dziś jest ".concat(["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","Sobota"][t.getDay()],", ").concat(t.toLocaleDateString("pl-PL"))})();